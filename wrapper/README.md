# jar包装器-Go 打包器代码

该目录为Go实现`jar`转`exe`的打包模板代码，通过修改配置文件之后，即可实现把你的`jar`文件和该Go源代码一起进行编译得到一个单独的`exe`文件。

通常使用构建器进行构建即可，请参阅主要文档：[传送门](../README.md)

本文档主要讲解如何通过该打包器代码手动构建`exe`程序。

## 1，安装Go开发环境

要想编译这个源代码，安装Go开发环境是必须的，在[官网](https://go.dev/)下载Go安装包进行安装即可，安装完成后，确保`go`命令可以正常使用。

## 2，修改配置文件

当前目录下的`config.yml`即为配置文件，其中有着非常详细的注释，可以根据其中注释提示进行修改，不过简单情况下，保持默认即可。若`config.yaml`不存在则手动创建一个，内容如下：

```yaml
# 配置文件

# 运行配置
run:
  # Java的运行路径，默认安装了Java运行环境的电脑直接填"java"即可，便携式jre需要在此指定，若指定为便携jre，则必须是相对路径，相对于生成的exe可执行文件的路径
  # 例如指定为"java"时，那么程序会使用该命令执行jar文件：java -jar path/to/xxx.jar
  # 如果指定为便携的jre，例如"jre/bin"，那么程序会使用该命令执行jar文件：jre/bin/java -jar path/to/xxx.jar
  java-path: "java"
  # 没有检测到Java运行环境时的提示内容
  error-message: "未能找到可用的Java运行环境（jre）！请先安装Java 8运行环境！"
  # 前置运行参数，即双击exe后自动加上的命令行参数，这个参数会先于命令行运行exe时加上的参数，该配置项为字符串数组类型
  pre-parameters:
# 日志相关
log:
  # 是否把程序的标准输出和标准错误重定向到本地文件，建议控制台应用程序不要开启此项
  write-to-file: false
  # 日志文件输出路径，为相对路径，为相对于可执行文件的位置，若上面变量write-to-file为false，则此配置项无效
  path: "error.log"
```

除此之外当前目录下还有一个名为`gui`的配置文件，这个配置文件用于标识该程序是GUI程序还是命令行程序，当该文件中内容为`y`时，表示该程序为GUI程序，运行时会屏蔽所有命令行窗口，若为其它值则为命令行程序。若该文件不存在则手动创建一个并填写`y`或者`n`即可。

## 3，将要转换的`jar`文件放进来

把你要转换成`exe`的`jar`文件重命名为`main.exe`，然后放到当前目录下即可。

## 4，执行编译

通过cmd或者其它命令行终端使用`cd`命令进入到当前目录下，使用`go build`命令即可进行编译。

如果你的`jar`程序是一个**命令行程序**，那么通过下列命令编译：

```bash
go build -ldflags "-w -s" -o "输出exe位置"
```

如果你的`jar`程序是一个**GUI窗体程序**，那么通过下列命令编译：

```bash
go build -ldflags "-H=windowsgui -w -s" -o "输出exe位置"
```

编译完成，就得到了一个可以直接运行的`exe`文件了！你的`jar`文件就已经包含在这个`exe`里面了！

## 5，自定义`exe`文件图标

如果需要自定义图标，请参考该文章：[传送门](https://juejin.cn/post/7281118263966351372)

需要在编译步骤之前完成图标资源编译。
